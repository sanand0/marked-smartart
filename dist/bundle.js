var de=Object.defineProperty;var fe=(e,t,r)=>t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var a=(e,t,r)=>fe(e,typeof t!="symbol"?t+"":t,r);var Q="https://stackblitz.com";var g=class{constructor(){a(this,"_bus",new EventTarget)}listen(t){function r(n){t(n.data)}return this._bus.addEventListener("message",r),()=>this._bus.removeEventListener("message",r)}fireEvent(t){this._bus.dispatchEvent(new MessageEvent("message",{data:t}))}};var pe=new Error;pe.stack="";var me=new g;function K(e){return me.listen(e)}var R={},S=null,E={get editorOrigin(){return S==null&&(S=new URL(globalThis.WEBCONTAINER_API_IFRAME_URL??Q).origin),S},set editorOrigin(e){S=new URL(e).origin},setQueryParam(e,t){R[e]=t},get url(){let e=new URL(this.editorOrigin);e.pathname="/headless";for(let t in R)e.searchParams.set(t,R[t]);return e.searchParams.set("version","1.5.3"),e}};function Z(){let e,t;function r(){t=new Promise(n=>e=n)}return r(),{get promise(){return t},resolve(n){return e(n)},reset:r}}var m={initialized:!1,bootCalled:!1,authComplete:Z(),clientId:"",oauthScope:"",broadcastChannel:null,get editorOrigin(){return E.editorOrigin},tokens:null},Ct=new g,Pt=new g;function ee(e){if(!e)throw new Error("Oops! Tokens is not defined when it always should be.")}var w;(function(e){e.UncaughtException="PREVIEW_UNCAUGHT_EXCEPTION",e.UnhandledRejection="PREVIEW_UNHANDLED_REJECTION",e.ConsoleError="PREVIEW_CONSOLE_ERROR"})(w||(w={}));var we=Object.defineProperty,ge=(e,t)=>{for(var r in t)we(e,r,{get:t[r],enumerable:!0})},h={};ge(h,{createEndpoint:()=>re,expose:()=>N,proxy:()=>le,proxyMarker:()=>I,releaseProxy:()=>ne,transfer:()=>ce,transferHandlers:()=>M,windowEndpoint:()=>be,wrap:()=>ie});var I=Symbol("Comlink.proxy"),re=Symbol("Comlink.endpoint"),ne=Symbol("Comlink.releaseProxy"),T=Symbol("Comlink.thrown"),oe=e=>typeof e=="object"&&e!==null||typeof e=="function",ye={canHandle:e=>oe(e)&&e[I],serialize(e){let{port1:t,port2:r}=new MessageChannel;return N(e,t),[r,[r]]},deserialize(e){return e.start(),ie(e)}},_e={canHandle:e=>oe(e)&&T in e,serialize({value:e}){let t;return e instanceof Error?t={isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:t={isError:!1,value:e},[t,[]]},deserialize(e){throw e.isError?Object.assign(new Error(e.value.message),e.value):e.value}},M=new Map([["proxy",ye],["throw",_e]]);function N(e,t=self){t.addEventListener("message",function r(n){if(!n||!n.data)return;let{id:o,type:s,path:i}=Object.assign({path:[]},n.data),c=(n.data.argumentList||[]).map(y),l;try{let u=i.slice(0,-1).reduce((d,p)=>d[p],e),f=i.reduce((d,p)=>d[p],e);switch(s){case 0:l=f;break;case 1:u[i.slice(-1)[0]]=y(n.data.value),l=!0;break;case 2:l=f.apply(u,c);break;case 3:{let d=new f(...c);l=le(d)}break;case 4:{let{port1:d,port2:p}=new MessageChannel;N(e,p),l=ce(d,[d])}break;case 5:l=void 0;break}}catch(u){l={value:u,[T]:0}}Promise.resolve(l).catch(u=>({value:u,[T]:0})).then(u=>{let[f,d]=D(u);t.postMessage(Object.assign(Object.assign({},f),{id:o}),d),s===5&&(t.removeEventListener("message",r),se(t))})}),t.start&&t.start()}function xe(e){return e.constructor.name==="MessagePort"}function se(e){xe(e)&&e.close()}function ie(e,t){return L(e,[],t)}function k(e){if(e)throw new Error("Proxy has been released and is not useable")}function L(e,t=[],r=function(){}){let n=!1,o=new Proxy(r,{get(s,i){if(k(n),i===ne)return()=>b(e,{type:5,path:t.map(c=>c.toString())}).then(()=>{se(e),n=!0});if(i==="then"){if(t.length===0)return{then:()=>o};let c=b(e,{type:0,path:t.map(l=>l.toString())}).then(y);return c.then.bind(c)}return L(e,[...t,i])},set(s,i,c){k(n);let[l,u]=D(c);return b(e,{type:1,path:[...t,i].map(f=>f.toString()),value:l},u).then(y)},apply(s,i,c){k(n);let l=t[t.length-1];if(l===re)return b(e,{type:4}).then(y);if(l==="bind")return L(e,t.slice(0,-1));let[u,f]=te(c);return b(e,{type:2,path:t.map(d=>d.toString()),argumentList:u},f).then(y)},construct(s,i){k(n);let[c,l]=te(i);return b(e,{type:3,path:t.map(u=>u.toString()),argumentList:c},l).then(y)}});return o}function Ee(e){return Array.prototype.concat.apply([],e)}function te(e){let t=e.map(D);return[t.map(r=>r[0]),Ee(t.map(r=>r[1]))]}var ae=new WeakMap;function ce(e,t){return ae.set(e,t),e}function le(e){return Object.assign(e,{[I]:!0})}function be(e,t=self,r="*"){return{postMessage:(n,o)=>e.postMessage(n,r,o),addEventListener:t.addEventListener.bind(t),removeEventListener:t.removeEventListener.bind(t)}}function D(e){for(let[t,r]of M)if(r.canHandle(e)){let[n,o]=r.serialize(e);return[{type:3,name:t,value:n},o]}return[{type:0,value:e},ae.get(e)||[]]}function y(e){switch(e.type){case 3:return M.get(e.name).deserialize(e.value);case 0:return e.value}}function b(e,t,r){return new Promise(n=>{let o=ve();e.addEventListener("message",function s(i){!i.data||!i.data.id||i.data.id!==o||(e.removeEventListener("message",s),n(i.data))}),e.start&&e.start(),e.postMessage(Object.assign({id:o},t),r)})}function ve(){return new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-")}var Se=[w.ConsoleError,w.UncaughtException,w.UnhandledRejection];function z(e){return!(e==null||typeof e!="object"||!("type"in e)||!Se.includes(e.type))}function _(e){let t=Object.create(null);return e?Object.assign(t,e):t}var ke=new TextDecoder("latin1");function F(e){let t={d:{}};for(let r of Object.keys(e)){let n=e[r];if("file"in n){if("symlink"in n.file){t.d[r]={f:{l:n.file.symlink}};continue}let s=n.file.contents,i=typeof s=="string"?s:ke.decode(s),c=typeof s=="string"?{}:{b:!0};t.d[r]={f:{c:i,...c}};continue}let o=F(n.directory);t.d[r]=o}return t}function j(e){let t=_();if("f"in e)throw new Error("It is not possible to export a single file in the JSON format.");if("d"in e)for(let r of Object.keys(e.d)){let n=e.d[r];"d"in n?t[r]=_({directory:j(n)}):"f"in n&&("c"in n.f?t[r]=_({file:_({contents:n.f.b?Ce(n.f.c):n.f.c})}):"l"in n.f&&(t[r]=_({file:_({symlink:n.f.l})})))}return t}function Ce(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r].charCodeAt(0);return t}var C=null,P=null,U={},ue=new TextDecoder,Pe=new TextEncoder,x=class x{constructor(t,r,n,o){a(this,"_instance");a(this,"_runtimeInfo");a(this,"fs");a(this,"_tornDown",!1);a(this,"_unsubscribeFromTokenChangedListener",()=>{});this._instance=t,this._runtimeInfo=o,this.fs=new G(r),m.initialized&&(this._unsubscribeFromTokenChangedListener=K(s=>{this._instance.setCredentials({accessToken:s,editorOrigin:m.editorOrigin})}),(async()=>{await m.authComplete.promise,!this._tornDown&&(ee(m.tokens),await this._instance.setCredentials({accessToken:m.tokens.access,editorOrigin:m.editorOrigin}))})().catch(s=>{console.error(s)}))}async spawn(t,r,n){let o=[];Array.isArray(r)?o=r:n=r;let s,i=new ReadableStream;if(n?.output!==!1){let X=Ie();s=X.push,i=X.stream}let c,l,u,f,d=$(V(s)),p=$(V(c)),A=$(V(u)),O=await this._instance.run({command:t,args:o,cwd:n?.cwd,env:n?.env,terminal:n?.terminal},p,A,d);return new H(O,i,l,f)}async export(t,r){let n={format:r?.format??"json",includes:r?.includes,excludes:r?.excludes,external:!0},o=await this._instance.serialize(t,n);if(n.format==="json"){let s=JSON.parse(ue.decode(o));return j(s)}return o}on(t,r){if(t==="preview-message"){let s=r;r=i=>{z(i)&&s(i)}}let{listener:n,subscribe:o}=Me(r);return o(this._instance.on(t,h.proxy(n)))}mount(t,r){let n=t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):Pe.encode(JSON.stringify(F(t)));return this._instance.loadFiles(h.transfer(n,[n.buffer]),{mountPoints:r?.mountPoint})}setPreviewScript(t,r){return this._instance.setPreviewScript(t,r)}get path(){return this._runtimeInfo.path}get workdir(){return this._runtimeInfo.cwd}teardown(){if(this._tornDown)throw new Error("WebContainer already torn down");this._tornDown=!0,this._unsubscribeFromTokenChangedListener(),this.fs._teardown(),this._instance.teardown(),this._instance[h.releaseProxy](),x._instance===this&&(x._instance=null)}static async boot(t={}){let{workdirName:r}=t;if(window.crossOriginIsolated&&t.coep==="none"&&console.warn(`A Cross-Origin-Embedder-Policy header is required in cross origin isolated environments.
Set the 'coep' option to 'require-corp'.`),r?.includes("/")||r===".."||r===".")throw new Error("workdirName should be a valid folder name");for(m.bootCalled=!0;C;)await C;if(x._instance)throw new Error("Only a single WebContainer instance can be booted");let n=Oe(t);C=n.catch(()=>{});try{let o=await n;return x._instance=o,o}finally{C=null}}};a(x,"_instance",null);var v=x;var $e=1,Ae=2,B=class{constructor(t,r){a(this,"name");a(this,"_type");this.name=t,this._type=r}isFile(){return this._type===$e}isDirectory(){return this._type===Ae}},W=class{constructor(t,r,n,o){a(this,"_apiClient");a(this,"_path");a(this,"_options");a(this,"_listener");a(this,"_wrappedListener");a(this,"_watcher");a(this,"_closed",!1);this._apiClient=t,this._path=r,this._options=n,this._listener=o,this._apiClient._watchers.add(this),this._wrappedListener=(s,i)=>{this._listener&&!this._closed&&this._listener(s,i)},this._apiClient._fs.watch(this._path,this._options,$(this._wrappedListener)).then(s=>{this._watcher=s,this._closed&&this._teardown()}).catch(console.error)}close(){this._closed||(this._closed=!0,this._apiClient._watchers.delete(this),this._teardown())}_teardown(){this._watcher?.close().finally(()=>{this._watcher?.[h.releaseProxy]()})}},H=class{constructor(t,r,n,o){a(this,"output");a(this,"input");a(this,"exit");a(this,"_process");a(this,"stdout");a(this,"stderr");this.output=r,this._process=t,this.input=new WritableStream({write:s=>{this._getProcess()?.write(s).catch(()=>{})}}),this.exit=this._onExit(),this.stdout=n,this.stderr=o}kill(){this._getProcess()?.kill()}resize(t){this._getProcess()?.resize(t)}async _onExit(){try{return await this._process.onExit}finally{this._process?.[h.releaseProxy](),this._process=null}}_getProcess(){return this._process==null&&console.warn("This process already exited"),this._process}},G=class{constructor(t){a(this,"_fs");a(this,"_watchers",new Set([]));this._fs=t}rm(...t){return this._fs.rm(...t)}async readFile(t,r){return await this._fs.readFile(t,r)}async rename(t,r){return await this._fs.rename(t,r)}async writeFile(t,r,n){if(r instanceof Uint8Array){let o=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);r=h.transfer(new Uint8Array(o),[o])}await this._fs.writeFile(t,r,n)}async readdir(t,r){let n=await this._fs.readdir(t,r);return Te(n)||Le(n)?n:n.map(s=>new B(s.name,s["Symbol(type)"]))}async mkdir(t,r){return await this._fs.mkdir(t,r)}watch(t,r,n){return typeof r=="function"&&(n=r,r=null),new W(this,t,r,n)}_teardown(){this._fs[h.releaseProxy]();for(let t of this._watchers)t.close()}};async function Oe(e){let{serverPromise:t}=Re(e),n=await(await t).build({host:window.location.host,version:"1.5.3",workdirName:e.workdirName,forwardPreviewErrors:e.forwardPreviewErrors}),[o,s,i]=await Promise.all([n.fs(),n.previewScript(),n.runtimeInfo()]);return new v(n,o,s,i)}function V(e){if(e!=null)return t=>{t instanceof Uint8Array?e(ue.decode(t)):t==null&&e(null)}}function $(e){if(e!=null)return h.proxy(e)}function Re(e){if(P!=null)return e.coep!==U.coep&&(console.warn(`Attempting to boot WebContainer with 'coep: ${e.coep}'`),console.warn(`First boot had 'coep: ${U.coep}', new settings will not take effect!`)),{serverPromise:P};e.coep&&E.setQueryParam("coep",e.coep),e.experimentalNode&&E.setQueryParam("experimental_node","1");let t=document.createElement("iframe");t.style.display="none",t.setAttribute("allow","cross-origin-isolated");let r=E.url;t.src=r.toString();let{origin:n}=r;return U={...e},P=new Promise(o=>{let s=i=>{if(i.origin!==n)return;let{data:c}=i;if(c.type==="init"){o(h.wrap(i.ports[0]));return}if(c.type==="warning"){console[c.level].call(console,c.message);return}};window.addEventListener("message",s)}),document.body.insertBefore(t,null),{serverPromise:P}}function Te(e){return typeof e[0]=="string"}function Le(e){return e[0]instanceof Uint8Array}function Ie(){let e=null;return{stream:new ReadableStream({start(n){e=n}}),push:n=>{n!=null?e?.enqueue(n):(e?.close(),e=null)}}}function Me(e){let t=!1,r=()=>{};return{subscribe(o){return o.then(s=>{r=s,t&&r()}),()=>{t=!0,r()}},listener:(...o)=>{t||e(...o)}}}document.addEventListener("DOMContentLoaded",()=>{let e=document.getElementById("input-area"),t=document.getElementById("output-area"),r=document.getElementById("render-btn"),n=document.getElementById("clear-btn"),o=document.getElementById("webc-output-frame");n.addEventListener("click",()=>{e.value="",t.innerHTML="",o.srcdoc=""}),r&&o&&r.addEventListener("click",async()=>{try{let s=e.value;o.srcdoc="<p><em>Rendering slides...</em></p>";let i=await v.boot();await Promise.all([i.fs.writeFile("/presentation.md",s),i.fs.writeFile("/package.json",JSON.stringify({name:"marp-smartart",type:"module",dependencies:{"@marp-team/marp-cli":"^4.1.2","@marp-team/marp-core":"^3.8.0"}},null,2))]),await i.fs.mkdir("/plugins");let c=["utils.js","pyramid.js","venn.js","chevron.js","smartart-plugin.js"];await Promise.all(c.map(async f=>{let d=window.location.pathname.includes("/dist/"),A=await fetch(`./${f}`).then(O=>O.text());return i.fs.writeFile(`/plugins/${f}`,A)})),await i.fs.writeFile("/marp-engine.js",`
import { Marp } from '@marp-team/marp-core';
import { smartartPlugin } from './plugins/smartart-plugin.js';

export default ({ marp }) => {
  smartartPlugin(marp);
  return marp;
};`),await(await i.spawn("npm",["install"])).exit,await(await i.spawn("npx",["marp","presentation.md","--html","--engine","./marp-engine.js","-o","output.html"])).exit,o.srcdoc=await i.fs.readFile("/output.html","utf8")}catch(s){console.error("Error rendering slides:",s),o.srcdoc=`<div style="color:red;padding:20px;">Error: ${s.message}</div>`}})});
//# sourceMappingURL=bundle.js.map
